# radspool
radspool.pl brings JSON formatted accounting data from OSC's Radiator RADIUS server into SQL and deals with potential SQL downtimes by spooling all accounting data as long as necessary.

## Description
The idea behind this script is to store accounting data first on the local filesystem of the Radiator host before it's going to be further processed and finally put into the SQL/DB backend. By having filesystem level access on the JSON formatted data, other applications can easily have access and participate as well (eg. exporting into ElasticSearch)

This script parses these accounting files and inserts them into a configured SQL backend. If the SQL backend is non-functional, cannot be accessed, has any certain issue that leads to an exception, it will SQL rollback (single transaction is started on each accounting file) and a commit omitted. If a file is completely inserted and no rollback was necessary a file will be deleted afterwards.

In case a specific SQL insert for whatever reason fails, the file we be left on disk until an execution of radspool will successfully commit finally. $SPOOLDIR will grow in that case by one new accounting file, each time the script is run again (the most recent Radiator acctlog-combined.json file will be moved into the spool directory). In certain situations it might be beneficial to have the flexibility in eg. configuring the transaction start/end points. In high volume setups it might be necessary to commit on "row-level" too reduce the storage need, while being fine with the much higher CPU and IO requirements generated by that decission. Hence some more all-around-this-and-that-configuration-options might be desirable.
